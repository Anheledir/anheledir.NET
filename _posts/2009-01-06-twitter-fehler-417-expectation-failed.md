---
layout: post
section-type: post
title: Twitter-Fehler 417 (Expectation Failed)
category: Unknown
tags: []
---
<p>Seit dem 23. Dezember 2008 verursachte der von mir verwendete Twitter-Wrapper “<a href="http://devblog.yedda.com/index.php/twitter-c-library/" target="_blank">Yedda’s C# wrapper</a>” beim Versuch den Tweet zu aktualisieren eine Ausnahme:</p>  <blockquote>   <p>Your tweet could not be sent: The remote server returned an error: (417) Expectation Failed.</p> </blockquote>  <p>Ich setze diese Funktion eigentlich nur in meinen Blogs ein um ein Update zu twittern sobald ein neuer Beitrag geschrieben wurde. Allerdings war es doch ein wenig ärgerlich das es nicht mehr ging und zwischen den Jahren habe ich deshalb ein wenig recherchiert. Bei <a href="http://blogs.msdn.com/shitals/archive/2008/12/27/9254245.aspx" target="_blank">Shital Shah</a> fand ich schließlich die Lösung: Twitter hat die Unterstützung für den HTTP-Header “<em>100-Continue</em>” – vermutlich aus Gründen der Performance – deaktiviert. Man muss also dieses Standartverhalten der HttpWebRequest-Klasse direkt in der Yedda-DLL abschalten damit diese wieder Aktualisierungen senden kann.</p>  <p>Da nicht jeder der den Wrapper verwendet auch Programmierer ist, der das mal eben schnell selber ändern und neukompilieren kann (<em>bsp. wenn man ein Blog-Plugin verwendet, dass auf die YeddaTwitter.dll angewiesen ist</em>), möchte ich hier die geänderte Version für alle zum Download bereitstellen inklusive dem geänderten Projekt.</p>  <p><strong>Downloads</strong></p>  <div style="border-right: #ccc 1px solid; padding-right: 5px; border-top: #ccc 1px solid; padding-left: 5px; float: left; padding-bottom: 5px; border-left: #ccc 1px solid; width: 230px; padding-top: 5px; border-bottom: #ccc 1px solid; height: 56px">   <p><a href="http://adef3a.bay.livefilestore.com/y1p64QoPL_BCzbA6m8rRRtQ71x9s-33GaYF7pNuXMPqDEcLfB0_0sLXgyxzT4dKlbfVPNwkgATKU2s/Yedda.Twitter.dll" target="_blank"><img title="Yedda.Twitter.Dll" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; margin-left: 0px; margin-right: 0px; border-right-width: 0px" height="54" alt="Yedda.Twitter.Dll" src="http://anheledirwp.blob.core.windows.net/wordpress/2009/01/Default.png" width="54" align="left" border="0" /></a> <a href="http://adef3a.bay.livefilestore.com/y1p64QoPL_BCzbA6m8rRRtQ71x9s-33GaYF7pNuXMPqDEcLfB0_0sLXgyxzT4dKlbfVPNwkgATKU2s/Yedda.Twitter.dll" target="_blank">Yedda.Twitter.Dll</a>       <br />DLL File       <br />11.5 KB</p> </div>  <div style="border-right: #ccc 1px solid; padding-right: 5px; border-top: #ccc 1px solid; padding-left: 5px; float: right; padding-bottom: 5px; border-left: #ccc 1px solid; width: 230px; padding-top: 5px; border-bottom: #ccc 1px solid; height: 56px">   <p><a href="http://adef3a.bay.livefilestore.com/y1pFcVU_XKzTLVxwZVf89c830R2XL6Pd_Akoj43e1gfg80yAOUYSrPLI-w1XhlxZ1S78Fqgh9c0fag/YeddaTwitter.7z?download" target="_blank"><img title="YeddaTwitter.7z" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; margin-left: 0px; margin-right: 0px; border-right-width: 0px" height="54" alt="YeddaTwitter.7z" src="http://anheledirwp.blob.core.windows.net/wordpress/2009/01/Default.png" width="54" align="left" border="0" /></a> <a href="http://adef3a.bay.livefilestore.com/y1pFcVU_XKzTLVxwZVf89c830R2XL6Pd_Akoj43e1gfg80yAOUYSrPLI-w1XhlxZ1S78Fqgh9c0fag/YeddaTwitter.7z?download" target="_blank">YeddaTwitter.7z</a>       <br />7z File       <br />4.8 KB</p> </div>  <p style="clear: both"><strong></strong></p>  <p style="clear: both"><strong>Vorsicht, Technik: Hintergrundinformationen</strong></p>  <p>Der HTTP-Header mit dem Wert “100-Continue” sagt dem Server, dass alle Daten in einer zweiten Anforderung übermittelt werden. Wenn der Server eine Weiterleitung oder Authentifizierung aktiviert hat wird diese also sofort bei dieser ersten Übermittlung an den Client gesendet ohne das überflüssige Daten bereits übermittelt wurden. Das hat bei der Übermittlung größerer Datenmengen und in langsamen Netzwerken Vorteile. Auch wenn ein Großteil der verwendeten Server eine Weiterleitung oder eine Authentifizierung aktiviert haben kann aus dem Verhalten ein Vorteil gezogen werden. Der Nachteil von dieser Methode ist allerdings, dass jetzt für jede Kommunikation doppelt so viele Anfragen an den Server gesendet werden und sich das bei hoher Last negativ auf die Server-Performance auswirkt.</p>  <p>Die <a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx" target="_blank">HttpWebRequest</a>-Klasse aus dem .NET-Framework sendet diesen HTTP-Header standartmäßig mit. Um ihn zu deaktivieren muss man die entsprechende Eigenschaft im <a href="http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.aspx" target="_blank">ServicePointManager</a> deaktivieren:</p>  <div class="wlWriterEditableSmartContent" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:9aeb1d4e-1636-49fc-b0b1-51bce3a6174d" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre name="code" class="c#:nogutter:nocontrols">System.Net.ServicePointManager.Expect100Continue = false;</pre></div>
